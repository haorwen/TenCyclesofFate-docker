services:
  app:
    image: docker.cnb.cool/haorwen/tencyclesoffate:latest
    container_name: elysia-game
    ports:
      - "${PORT:-8000}:8000"
    # 默认会自动加载当前目录下的 .env 文件
    volumes:
      - ./data:/workspace/data
      # 如果需要持久化 sqlite 数据库，可以取消下面的注释并将 DATABASE_URL 设置为指向 /workspace/data/veloera.db
      # - ./veloera.db:/workspace/veloera.db
    restart: always
    environment:
      - HOST=0.0.0.0
      - PORT=8000
      - UVICORN_RELOAD=false
      # OpenAI API 配置
      - OPENAI_API_KEY=${OPENAI_API_KEY:-}
      - OPENAI_BASE_URL=${OPENAI_BASE_URL:-https://api.openai.com/v1}
      - OPENAI_MODEL=${OPENAI_MODEL:-gpt-3.5-turbo}
      - OPENAI_MODEL_CHEAT_CHECK=${OPENAI_MODEL_CHEAT_CHECK:-gpt-3.5-turbo}
      # 安全与 OAuth 密钥
      - SECRET_KEY=${SECRET_KEY:-some_random_secret_key_change_me}
      - LINUXDO_CLIENT_ID=${LINUXDO_CLIENT_ID:-}
      - LINUXDO_CLIENT_SECRET=${LINUXDO_CLIENT_SECRET:-}
      # Linux.do OAuth URLs (可选，有默认值)
      - LINUXDO_AUTHORIZE_URL=${LINUXDO_AUTHORIZE_URL:-https://connect.linux.do/oauth2/authorize}
      - LINUXDO_TOKEN_URL=${LINUXDO_TOKEN_URL:-https://connect.linux.do/oauth2/token}
      - LINUXDO_API_BASE_URL=${LINUXDO_API_BASE_URL:-https://connect.linux.do/}
      # 数据库配置
      - DATABASE_URL=${DATABASE_URL:-sqlite:///./data/veloera.db}
      # 功能开关
      - ENABLE_LINUXDO_LOGIN=${ENABLE_LINUXDO_LOGIN:-false}
      - ENABLE_REDEMPTION=${ENABLE_REDEMPTION:-false}